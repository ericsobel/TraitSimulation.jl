<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Model Specifications - TraitSimulation.jl</title>
      
      
      
      
        <meta name="author" content="Huwenbo Shi">
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="TraitSimulation.jl">
    <meta property="og:image" content="None/../../">
    <meta name="apple-mobile-web-app-title" content="TraitSimulation.jl">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application-a422ff04cc.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/palettes-05ab2406df.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../../assets/Documenter.css">
    
    <script src="../../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class="palette-primary-indigo palette-accent-blue">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
          </span>
        
        Model Specifications
      </div>
    </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/huwenboshi/TraitSimulation.jl" class="project">
    <div class="banner">
      
      <div class="name">
        <strong>
          TraitSimulation.jl
          <span class="version">
            
          </span>
        </strong>
        
          <br>
          huwenboshi/TraitSimulation.jl
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/huwenboshi/TraitSimulation.jl/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/huwenboshi/TraitSimulation.jl/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Introduction" href="../..">
      Introduction
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Getting Started" href="../../example/example/">
      Getting Started
    </a>
    
  </li>

          
            
  <li>
    <a class="current" title="Model Specifications" href="./">
      Model Specifications
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="SimulationModel" href="#simulationmodel">
                SimulationModel
              </a>
            </li>
          
            <li class="anchor">
              <a title="FixedEffectModel" href="#fixedeffectmodel">
                FixedEffectModel
              </a>
            </li>
          
            <li class="anchor">
              <a title="RandomEffectModel" href="#randomeffectmodel">
                RandomEffectModel
              </a>
            </li>
          
            <li class="anchor">
              <a title="MixedEffectModel" href="#mixedeffectmodel">
                MixedEffectModel
              </a>
            </li>
          
            <li class="anchor">
              <a title="VarianceComponent" href="#variancecomponent">
                VarianceComponent
              </a>
            </li>
          
        </ul>
      
    
  </li>

          
            
  <li>
    <a class="" title="Generate Simulations" href="../../generate/generate/">
      Generate Simulations
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Link Functions" href="../../link/link/">
      Link Functions
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Response Distributions" href="../../dist/dist/">
      Response Distributions
    </a>
    
  </li>

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <p><a id='Model-Specifications-1'></a></p>
<h1 id="model-specifications">Model Specifications</h1>
<p>This section introduces the <code>SimulationModel</code> type for specifying the simulation model. Other types mentioned in this section are introduced in detail in the following sections.</p>
<p><a id='SimulationModel-1'></a></p>
<h2 id="simulationmodel">SimulationModel</h2>
<p><code>SimulationModel</code> is an abstract supertype for each spefic simulation model.</p>
<p><a id='FixedEffectModel-1'></a></p>
<h2 id="fixedeffectmodel">FixedEffectModel</h2>
<p><code>FixedEffectModel</code> is a type to specify simulations under the fixed-effect model. It&rsquo;s a subtype of <code>SimulationModel</code>.</p>
<div class="codehilite"><pre><span class="n">FixedEffectModel</span><span class="p">(</span><span class="n">frml</span><span class="p">::</span><span class="n">FormulaType</span><span class="p">,</span>
                 <span class="n">link</span><span class="p">::</span><span class="n">LinkFunctionType</span>
                 <span class="n">dist</span><span class="p">::</span><span class="n">ResponseDistributionType</span><span class="p">)</span>
</pre></div>


<p><code>frml</code> can be a single formula, in which case, a single trait will be simulated, or an array of formula, in which case, multiple traits will be simulated. Here, we use the <code>Formula</code> type in the <code>DataFrames</code> module.</p>
<p><code>link</code> can be a single <code>LinkFunction</code>, in which case, all traits will be simulated under the same link function, or an array of <code>LinkFunction</code>, in which case, each trait will be simulated under its own link function.</p>
<p><code>dist</code> can be a single <code>ResponseDistribution</code>, in which case, all traits will have the same response distribution, or an array of <code>ResponseDistribution</code>, in which case, each trait will have its own response distribution.</p>
<p><a id='RandomEffectModel-1'></a></p>
<h2 id="randomeffectmodel">RandomEffectModel</h2>
<p><code>RandomEffectModel</code> is a type to specify simulations under the random effect model. It&rsquo;s a subtype of <code>SimulationModel</code>.</p>
<div class="codehilite"><pre><span class="n">RandomEffectModel</span><span class="p">(</span><span class="n">traits</span><span class="p">::</span><span class="n">TraitType</span><span class="p">,</span>
                  <span class="n">vc</span><span class="p">::</span><span class="n">Vector</span><span class="p">{</span><span class="n">VarianceComponent</span><span class="p">},</span>
                  <span class="n">link</span><span class="p">::</span><span class="n">LinkFunctionType</span><span class="p">,</span>
                  <span class="n">resp_dist</span><span class="p">::</span><span class="n">ResponseDistributionType</span><span class="p">)</span>
</pre></div>


<p><code>traits</code> can be a single symbol, in which case, a single trait will be simulated, or an array of symbol, in which case multiple traits will be simulated.</p>
<p><code>vc</code> is an array of variance components / cross covariances and the corresponding covariance matrices. See the section on the <code>VarianceComponent</code> type for more detail.</p>
<p><a id='MixedEffectModel-1'></a></p>
<h2 id="mixedeffectmodel">MixedEffectModel</h2>
<p><code>MixedEffectModel</code> is a type of specify simulations under a fixed-effect model. It&rsquo;s a subtype of <code>SimulationModel</code>.</p>
<div class="codehilite"><pre><span class="n">MixedEffectModel</span><span class="p">(</span><span class="n">formula</span><span class="p">::</span><span class="n">FormulaType</span><span class="p">,</span>
                 <span class="n">vc</span><span class="p">::</span><span class="n">Vector</span><span class="p">{</span><span class="n">VarianceComponent</span><span class="p">},</span>
                 <span class="n">link</span><span class="p">::</span><span class="n">LinkFunctionType</span><span class="p">,</span>
                 <span class="n">resp_dist</span><span class="p">::</span><span class="n">ResponseDistributionType</span><span class="p">)</span>
</pre></div>


<p><a id='Specifying-the-variance-components-1'></a></p>
<h3 id="specifying-the-variance-components">Specifying the variance components</h3>
<div class="codehilite"><pre><span class="n">Model</span><span class="p">(</span><span class="n">frml</span><span class="p">::</span><span class="n">Union</span><span class="p">{</span><span class="n">Formula</span><span class="p">,</span> <span class="n">Vector</span><span class="p">{</span><span class="n">Formula</span><span class="p">}},</span>
      <span class="n">vc</span><span class="p">::</span><span class="n">Vector</span><span class="p">{</span><span class="n">VarianceComponent</span><span class="p">},</span>
      <span class="n">link</span><span class="p">::</span><span class="n">Union</span><span class="p">{</span><span class="n">LinkFunction</span><span class="p">,</span> <span class="n">Vector</span><span class="p">{</span><span class="n">LinkFunction</span><span class="p">}},</span>
      <span class="n">dist</span><span class="p">::</span><span class="n">Union</span><span class="p">{</span><span class="n">ResponseDistribution</span><span class="p">,</span> <span class="n">Vector</span><span class="p">{</span><span class="n">ResponseDistribution</span><span class="p">}})</span>
</pre></div>


<p>In addition to the three parameters in the fixed-effect model constructor, the mixed-effect model constructors requires the additional parameter <code>vc</code>, an array of variance components. See next section for details on the <code>VarianceComponent</code> type.</p>
<p><a id='VarianceComponent-1'></a></p>
<h2 id="variancecomponent">VarianceComponent</h2>
<div class="codehilite"><pre><span class="n">VarianceComponent</span><span class="p">(</span><span class="n">var_comp</span><span class="p">::</span><span class="n">Union</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span> <span class="n">Vector</span><span class="p">{</span><span class="kt">Float64</span><span class="p">},</span> <span class="n">Matrix</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}}</span>
                  <span class="n">cov_mat</span><span class="p">::</span><span class="n">Matrix</span><span class="p">{</span><span class="kt">Float64</span><span class="p">})</span>
</pre></div>


<p>The <code>var_comp</code> parameter specifies the variance component or the cross covariance matrix to be simulated. If <code>var_comp</code> is of type <code>Vector{Float64}</code>, it will be interpreted as a cross covariance matrix with off-diagnal elements equal to 0.</p>
<p><a id='operator-1'></a></p>
<h3 id="operator">operator ⊗</h3>
<p>The TraitSimulation module implements the <code>⊗</code> operator to compute the Kronecker product between two matrices.</p>
<div class="codehilite"><pre><span class="n">⊗</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="o">=</span> <span class="n">kron</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre></div>


<p><a id='macro-@vc-1'></a></p>
<h3 id="macro-vc">macro @vc</h3>
<p>The TraitSimulation module provides a macro <code>@vc</code> to simplify the specification of variance components. The following code snippet lists some equivalent ways to specify the variance components in the simulation model. The terms in the expression to the right of <code>@vc</code> must be defined.</p>
<div class="codehilite"><pre><span class="c"># a fake GRM</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">cor</span><span class="p">(</span><span class="n">data</span><span class="o">&#39;</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">eye</span><span class="p">(</span><span class="n">npeople</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">;</span> <span class="o">-</span><span class="mf">0.1</span> <span class="mf">0.3</span><span class="p">]</span>
<span class="n">B</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.8</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">;</span> <span class="o">-</span><span class="mf">0.2</span> <span class="mf">0.7</span><span class="p">]</span>

<span class="c"># the following two ways to specify Σ are equivalent</span>
<span class="n">Σ</span> <span class="o">=</span> <span class="p">[</span><span class="n">VarianceComponent</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">K</span><span class="p">),</span> <span class="n">VarianceComponent</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">I</span><span class="p">)]</span>
<span class="n">Σ</span> <span class="o">=</span> <span class="p">@</span><span class="n">vc</span> <span class="mf">0.2</span><span class="n">K</span> <span class="o">+</span> <span class="mf">0.8</span><span class="n">I</span> 

<span class="c"># the following two ways to specify Σ are equivalent</span>
<span class="n">Σ</span> <span class="o">=</span> <span class="p">[</span><span class="n">VarianceComponent</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">K</span><span class="p">),</span> <span class="n">VarianceComponent</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">I</span><span class="p">)]</span>
<span class="n">Σ</span> <span class="o">=</span> <span class="p">@</span><span class="n">vc</span> <span class="n">A</span> <span class="n">⊗</span> <span class="n">K</span> <span class="o">+</span> <span class="n">B</span> <span class="n">⊗</span> <span class="n">I</span>
</pre></div>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../../example/example/" title="Getting Started">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Getting Started
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../../generate/generate/" title="Generate Simulations">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Generate Simulations
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = 'huwenboshi/TraitSimulation.jl';
    </script>
    <script src="../../assets/javascripts/application-997097ee0c.js"></script>
    
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    
      <script src="../../assets/mathjaxhelper.js"></script>
    
    
  </body>
</html>